# Rime schema
# encoding: utf-8

patch:
  switches:
    - name: ascii_mode
      reset: 0  # é»˜è®¤ä¸­æ–‡æ¨¡å¼
      states: [ ä¸­, è‹± ]  # ä¸­æ–‡æ˜¾ç¤º"ä¸­"ï¼Œè‹±æ–‡æ˜¾ç¤º"è‹±"
    - name: ascii_punct
      reset: 0  # é»˜è®¤ä¸­æ–‡æ ‡ç‚¹
      states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]  # ä¸­æ–‡æ ‡ç‚¹æ˜¾ç¤º"ã€‚ï¼Œ"ï¼Œè‹±æ–‡æ ‡ç‚¹æ˜¾ç¤º"ï¼ï¼Œ"
    - name: simplification
      reset: 1 # é»˜è®¤ç®€ä¸­
      states: [ æ¼¢å­—, æ±‰å­— ]
    - name: full_shape
      reset: 0 # é»˜è®¤åŠè§’
      states: [ åŠè§’, å…¨è§’ ]
  ascii_composer:
    switch_key:
      Caps_Lock: clear     # ä¸­æ–‡æ¨¡å¼ä¸‹ç»å¸¸ç”¨ Vim å¿«æ·é”®è¢«è¿«è¾“å…¥ä¸€å †è‹±æ–‡
                           # è®¾ç½®åˆ‡æ¢ä¸­è‹±æ–‡æ¸…ç©º
      Shift_L: commit_code # å·¦ Shift ç›´æ¥ä¸Šå±
  punctuator:
    import_preset: default
    half_shape:
      ",": "ï¼Œ"
      ".": "ã€‚"
      "/": "/"
      "#": "#"
      "@": "@"
      "$": "ï¿¥"
      "%": "%"  # åŠè§’
      "*": "*"  # åŠè§’
      "+": "+"  # åŠè§’
      "^": "^"  # åŠè§’
      "=": "="
  #    "`": "```"
      "ï½": "~"
      "<": "ã€Š"
      ">": "ã€‹"
      "[": "ã€"
      "\\": "ã€"
      "]": "ã€‘"
      "{": "ã€"
      "|": "|"  # åŠè§’
      "}": "ã€"
  # å¯ç”¨ emoji
  # src: https://github.com/rime/rime-emoji/blob/master/emoji_suggestion.yaml
  switches/@next:
    name: emoji_suggestion
    reset: 1
    states: [ "ğŸˆšï¸", "ğŸˆ¶ï¸" ]
  'engine/filters/@before 0':
    simplifier@emoji_suggestion
  emoji_suggestion:
    opencc_config: emoji.json
    option_name: emoji_suggestion
    tips: none
    inherit_comment: false
  engine/+:
    translators/+:
      - lua_translator@*date_translator
  # åœ¨åŒæ‹¼æ˜ å°„ä¹‹å‰ï¼Œå°†è¾“å…¥å±•å¼€ä¸º $1 | $1
  # åœ¨æœ€åå˜ä¸º $1(åŒæ‹¼ç ) | $1(å…¨æ‹¼ç )
  # src: https://github.com/rime/rime-double-pinyin/issues/6
  'translator/preedit_format/@before 0': 'xform/^(.*)$/\U$1\E\t$1/'
  'translator/preedit_format/@after last': 'xform/^([A-Z ]*)(.*)$/\L$1ã€”$2ã€•\E/'

  # è¯†åˆ«å™¨ï¼šè¯†åˆ«å¤§å†™å­—æ¯å¼€å¤´çš„è¾“å…¥ï¼Œç›´æ¥ä¸Šå±
  recognizer:
    patterns:
      email: "^[A-Za-z][-_.0-9A-Za-z]*@.*$"      # è¯†åˆ«é‚®ç®±åœ°å€
      uppercase: "[A-Z][-_+.'0-9A-Za-z]*$"       # è¯†åˆ«å¤§å†™å­—æ¯
      url: "^(www[.]|https?:|ftp[.:]|mailto:|file:).*$|^[a-z]+[.].+$"  # è¯†åˆ« URL

  # æŒ‰é”®ç»‘å®šï¼šå¿«æ·é”®é…ç½®
  key_binder:
    bindings:
      - { when: always, accept: Control+period, toggle: ascii_punct }  # Ctrl+. åˆ‡æ¢ä¸­è‹±æ–‡æ ‡ç‚¹
      # ç¿»é¡µæŒ‰é”®ï¼ˆåœ¨æœ‰å€™é€‰è¯æ—¶ï¼‰
      - { when: has_menu, accept: minus, send: Page_Up }      # - é”®å‘å‰ç¿»é¡µ
      - { when: has_menu, accept: equal, send: Page_Down }    # = é”®å‘åç¿»é¡µ
      - { when: paging, accept: minus, send: Page_Up }        # ç¿»é¡µæ¨¡å¼ä¸‹ - é”®
      - { when: paging, accept: equal, send: Page_Down }      # ç¿»é¡µæ¨¡å¼ä¸‹ = é”®
      # Tab é”®ç¿»é¡µ
      - { when: has_menu, accept: Tab, send: Page_Down }      # Tab é”®å‘åç¿»é¡µ
      - { when: has_menu, accept: Shift+Tab, send: Page_Up }  # Shift+Tab å‘å‰ç¿»é¡µ
      - { when: paging, accept: Tab, send: Page_Down }        # ç¿»é¡µæ¨¡å¼ä¸‹ Tab é”®
      - { when: paging, accept: Shift+Tab, send: Page_Up }    # ç¿»é¡µæ¨¡å¼ä¸‹ Shift+Tab
